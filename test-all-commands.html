<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Command Test - HackSimulator (30 commands)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #0f0;
            padding: 20px;
            line-height: 1.4;
        }
        h1 {
            color: #0f0;
            font-size: 1.5em;
            margin-bottom: 10px;
            text-align: center;
        }
        .stats {
            text-align: center;
            margin-bottom: 20px;
            padding: 10px;
            border: 2px solid #0f0;
        }
        .category {
            margin: 20px 0;
            border: 1px solid #0a0;
            padding: 15px;
        }
        .category h2 {
            color: #0f0;
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        .commands {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        button {
            background: #000;
            color: #0f0;
            border: 1px solid #0a0;
            padding: 8px 12px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            transition: all 0.2s;
            text-align: left;
        }
        button:hover {
            background: #0f0;
            color: #000;
            border-color: #0f0;
        }
        button.tested {
            background: #003300;
            border-color: #0f0;
        }
        button.failed {
            background: #330000;
            border-color: #f00;
            color: #f00;
        }
        .output {
            background: #000;
            border: 1px solid #0a0;
            padding: 15px;
            margin-top: 15px;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
            font-size: 0.85em;
        }
        .control-panel {
            position: sticky;
            top: 0;
            background: #000;
            border: 2px solid #0f0;
            padding: 15px;
            margin-bottom: 20px;
            z-index: 100;
        }
        .control-panel button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 1em;
            font-weight: bold;
        }
        .success { color: #0f0; }
        .error { color: #f00; }
        .warning { color: #ff0; }
        #main-output {
            position: sticky;
            bottom: 0;
            background: #000;
        }
        .loading {
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
    </style>
</head>
<body>
    <h1>üß™ HackSimulator - Complete Command Test Suite</h1>

    <div class="stats">
        <div>Total Commands: <span id="total-count">30</span></div>
        <div>Tested: <span id="tested-count" class="success">0</span></div>
        <div>Passed: <span id="passed-count" class="success">0</span></div>
        <div>Failed: <span id="failed-count" class="error">0</span></div>
        <div>Success Rate: <span id="success-rate">0%</span></div>
    </div>

    <div class="control-panel">
        <button onclick="runAllTests()" style="background: #003300;">‚ñ∂ RUN ALL TESTS</button>
        <button onclick="runCategoryTests('system')">Test System (7)</button>
        <button onclick="runCategoryTests('filesystem')">Test Filesystem (11)</button>
        <button onclick="runCategoryTests('network')">Test Network (6)</button>
        <button onclick="runCategoryTests('security')">Test Security (5)</button>
        <button onclick="clearOutput()">Clear Output</button>
        <button onclick="resetTests()">Reset Tests</button>
    </div>

    <!-- System Commands -->
    <div class="category">
        <h2>üìü System Commands (7)</h2>
        <div class="commands">
            <button onclick="testCommand('clear')">clear</button>
            <button onclick="testCommand('help')">help</button>
            <button onclick="testCommand('man help')">man help</button>
            <button onclick="testCommand('history')">history</button>
            <button onclick="testCommand('echo Hello World')">echo</button>
            <button onclick="testCommand('date')">date</button>
            <button onclick="testCommand('whoami')">whoami</button>
        </div>
    </div>

    <!-- Filesystem Commands -->
    <div class="category">
        <h2>üìÅ Filesystem Commands (11)</h2>
        <div class="commands">
            <button onclick="testCommand('ls')">ls</button>
            <button onclick="testCommand('ls -la')">ls -la</button>
            <button onclick="testCommand('cd /etc')">cd /etc</button>
            <button onclick="testCommand('pwd')">pwd</button>
            <button onclick="testCommand('cat /etc/passwd')">cat</button>
            <button onclick="testCommand('mkdir testdir')">mkdir</button>
            <button onclick="testCommand('touch test.txt')">touch</button>
            <button onclick="testCommand('rm test.txt')">rm</button>
            <button onclick="testCommand('cp README.txt backup.txt')">cp</button>
            <button onclick="testCommand('mv backup.txt renamed.txt')">mv</button>
            <button onclick="testCommand('find passwd')">find</button>
            <button onclick="testCommand('grep hacker /etc/passwd')">grep</button>
        </div>
    </div>

    <!-- Network Commands -->
    <div class="category">
        <h2>üåê Network Commands (6)</h2>
        <div class="commands">
            <button onclick="testCommand('ping 8.8.8.8')">ping</button>
            <button onclick="testCommand('nmap 192.168.1.100')">nmap</button>
            <button onclick="testCommand('ifconfig')">ifconfig</button>
            <button onclick="testCommand('netstat')">netstat</button>
            <button onclick="testCommand('whois google.com')">whois</button>
            <button onclick="testCommand('traceroute google.com')">traceroute</button>
        </div>
    </div>

    <!-- Security Commands -->
    <div class="category">
        <h2>üîê Security Commands (5)</h2>
        <div class="commands">
            <button onclick="testCommand('hashcat 5f4dcc3b5aa765d61d8327deb882cf99')">hashcat</button>
            <button onclick="testCommand('hydra ssh://192.168.1.100')">hydra</button>
            <button onclick="testCommand('sqlmap http://vulnerable-site.com/product?id=1')">sqlmap</button>
            <button onclick="testCommand('metasploit')">metasploit</button>
            <button onclick="testCommand('nikto http://testsite.local')">nikto</button>
        </div>
    </div>

    <!-- Special Commands -->
    <div class="category">
        <h2>‚öôÔ∏è Special Commands (1)</h2>
        <div class="commands">
            <button onclick="testCommand('reset')">reset</button>
        </div>
    </div>

    <div class="output" id="main-output">
        <div class="success">‚úì Ready to test. Click any command or use control panel.</div>
        <div style="margin-top: 10px; color: #888;">
Server: http://localhost:8002
Test started: <span id="start-time">-</span>
        </div>
    </div>

    <script type="module">
        import terminal from './src/core/terminal.js';
        import registry from './src/core/registry.js';
        import vfs from './src/filesystem/vfs.js';

        // Import all commands
        import clearCmd from './src/commands/system/clear.js';
        import echoCmd from './src/commands/system/echo.js';
        import whoamiCmd from './src/commands/system/whoami.js';
        import dateCmd from './src/commands/system/date.js';
        import historyCmd from './src/commands/system/history.js';
        import helpCmd from './src/commands/system/help.js';
        import manCmd from './src/commands/system/man.js';

        import lsCmd from './src/commands/filesystem/ls.js';
        import cdCmd from './src/commands/filesystem/cd.js';
        import pwdCmd from './src/commands/filesystem/pwd.js';
        import catCmd from './src/commands/filesystem/cat.js';
        import mkdirCmd from './src/commands/filesystem/mkdir.js';
        import touchCmd from './src/commands/filesystem/touch.js';
        import rmCmd from './src/commands/filesystem/rm.js';
        import cpCmd from './src/commands/filesystem/cp.js';
        import mvCmd from './src/commands/filesystem/mv.js';
        import findCmd from './src/commands/filesystem/find.js';
        import grepCmd from './src/commands/filesystem/grep.js';

        import resetCmd from './src/commands/special/reset.js';

        import pingCmd from './src/commands/network/ping.js';
        import nmapCmd from './src/commands/network/nmap.js';
        import ifconfigCmd from './src/commands/network/ifconfig.js';
        import netstatCmd from './src/commands/network/netstat.js';
        import whoisCmd from './src/commands/network/whois.js';
        import tracerouteCmd from './src/commands/network/traceroute.js';

        import hashcatCmd from './src/commands/security/hashcat.js';
        import hydraCmd from './src/commands/security/hydra.js';
        import sqlmapCmd from './src/commands/security/sqlmap.js';
        import metasploitCmd from './src/commands/security/metasploit.js';
        import niktoCmd from './src/commands/security/nikto.js';

        // Register all commands
        registry.register('clear', clearCmd);
        registry.register('echo', echoCmd);
        registry.register('whoami', whoamiCmd);
        registry.register('date', dateCmd);
        registry.register('history', historyCmd);
        registry.register('help', helpCmd);
        registry.register('man', manCmd);

        registry.register('ls', lsCmd);
        registry.register('cd', cdCmd);
        registry.register('pwd', pwdCmd);
        registry.register('cat', catCmd);
        registry.register('mkdir', mkdirCmd);
        registry.register('touch', touchCmd);
        registry.register('rm', rmCmd);
        registry.register('cp', cpCmd);
        registry.register('mv', mvCmd);
        registry.register('find', findCmd);
        registry.register('grep', grepCmd);

        registry.register('reset', resetCmd);

        registry.register('ping', pingCmd);
        registry.register('nmap', nmapCmd);
        registry.register('ifconfig', ifconfigCmd);
        registry.register('netstat', netstatCmd);
        registry.register('whois', whoisCmd);
        registry.register('traceroute', tracerouteCmd);

        registry.register('hashcat', hashcatCmd);
        registry.register('hydra', hydraCmd);
        registry.register('sqlmap', sqlmapCmd);
        registry.register('metasploit', metasploitCmd);
        registry.register('nikto', niktoCmd);

        console.log('‚úì Registered commands:', registry.list());
        console.log('‚úì Total:', registry.getStats().total);

        // Test statistics
        let stats = {
            tested: 0,
            passed: 0,
            failed: 0
        };

        // Test command function
        window.testCommand = async function(commandStr) {
            const outputEl = document.getElementById('main-output');
            const button = event.target;

            outputEl.innerHTML = `<span class="loading">$ ${commandStr}\n\nExecuting...</span>`;
            button.classList.add('loading');

            try {
                // Execute via registry directly to get output
                const parsed = commandStr.split(' ');
                const cmdName = parsed[0];
                const args = parsed.slice(1);

                const result = await registry.execute(cmdName, args, {}, {
                    terminal: terminal,
                    vfs: vfs,
                    historyManager: null,
                    cwd: vfs.getCwd(),
                    user: 'hacker',
                    hostname: 'hacksim'
                });

                // Success
                outputEl.innerHTML = `<span class="success">$ ${commandStr}\n\n${result}\n\n‚úì Command executed successfully</span>`;
                button.classList.remove('loading', 'failed');
                button.classList.add('tested');

                stats.tested++;
                stats.passed++;

            } catch (error) {
                // Error
                outputEl.innerHTML = `<span class="error">$ ${commandStr}\n\n‚úó ERROR: ${error.message}\n\nStack: ${error.stack}</span>`;
                button.classList.remove('loading', 'tested');
                button.classList.add('failed');

                stats.tested++;
                stats.failed++;
            }

            updateStats();
        };

        // Run all tests
        window.runAllTests = async function() {
            const startTime = new Date();
            document.getElementById('start-time').textContent = startTime.toLocaleTimeString('nl-NL');

            const allCommands = [
                // System
                'clear', 'help', 'man help', 'history', 'echo Test', 'date', 'whoami',
                // Filesystem
                'ls', 'ls -la', 'cd /etc', 'pwd', 'cat /etc/passwd',
                'mkdir testdir', 'touch test.txt', 'rm test.txt',
                'cp README.txt backup.txt', 'mv backup.txt renamed.txt',
                'find passwd', 'grep hacker /etc/passwd',
                // Network
                'ping 8.8.8.8', 'nmap 192.168.1.100', 'ifconfig', 'netstat',
                'whois google.com', 'traceroute google.com',
                // Security
                'hashcat 5f4dcc3b5aa765d61d8327deb882cf99',
                'hydra ssh://192.168.1.100',
                'sqlmap http://site.com/page?id=1',
                'metasploit', 'nikto http://test.local',
                // Special
                'reset'
            ];

            const outputEl = document.getElementById('main-output');
            outputEl.innerHTML = '<span class="loading">Running all tests...</span>\n\n';

            let testResults = [];

            for (let i = 0; i < allCommands.length; i++) {
                const cmd = allCommands[i];
                const progress = `[${i + 1}/${allCommands.length}]`;

                outputEl.innerHTML += `${progress} Testing: ${cmd}...\n`;

                try {
                    const parsed = cmd.split(' ');
                    const cmdName = parsed[0];
                    const args = parsed.slice(1);

                    await registry.execute(cmdName, args, {}, {
                        terminal: terminal,
                        vfs: vfs,
                        historyManager: null,
                        cwd: vfs.getCwd(),
                        user: 'hacker',
                        hostname: 'hacksim'
                    });

                    testResults.push({ cmd, status: 'PASS' });
                    outputEl.innerHTML += `${progress} ‚úì ${cmd}\n`;
                    stats.passed++;
                } catch (error) {
                    testResults.push({ cmd, status: 'FAIL', error: error.message });
                    outputEl.innerHTML += `${progress} ‚úó ${cmd} - ${error.message}\n`;
                    stats.failed++;
                }

                stats.tested++;
                updateStats();

                // Small delay for visibility
                await new Promise(resolve => setTimeout(resolve, 100));
            }

            // Summary
            const endTime = new Date();
            const duration = ((endTime - startTime) / 1000).toFixed(2);

            outputEl.innerHTML += `\n${'='.repeat(60)}\n`;
            outputEl.innerHTML += `TEST SUMMARY\n`;
            outputEl.innerHTML += `${'='.repeat(60)}\n`;
            outputEl.innerHTML += `Total: ${allCommands.length}\n`;
            outputEl.innerHTML += `<span class="success">Passed: ${stats.passed}</span>\n`;
            outputEl.innerHTML += `<span class="error">Failed: ${stats.failed}</span>\n`;
            outputEl.innerHTML += `Duration: ${duration}s\n`;
            outputEl.innerHTML += `Success Rate: ${((stats.passed / allCommands.length) * 100).toFixed(1)}%\n`;

            // Mark all buttons
            document.querySelectorAll('button').forEach(btn => {
                const btnText = btn.textContent.toLowerCase();
                const result = testResults.find(r => r.cmd.toLowerCase().includes(btnText));
                if (result) {
                    btn.classList.add(result.status === 'PASS' ? 'tested' : 'failed');
                }
            });
        };

        // Run category tests
        window.runCategoryTests = async function(category) {
            const categoryCommands = {
                'system': ['clear', 'help', 'man help', 'history', 'echo Test', 'date', 'whoami'],
                'filesystem': ['ls', 'ls -la', 'cd /etc', 'pwd', 'cat /etc/passwd', 'mkdir testdir', 'touch test.txt', 'rm test.txt', 'cp README.txt backup.txt', 'mv backup.txt renamed.txt', 'find passwd', 'grep hacker /etc/passwd'],
                'network': ['ping 8.8.8.8', 'nmap 192.168.1.100', 'ifconfig', 'netstat', 'whois google.com', 'traceroute google.com'],
                'security': ['hashcat 5f4dcc3b5aa765d61d8327deb882cf99', 'hydra ssh://192.168.1.100', 'sqlmap http://site.com/page?id=1', 'metasploit', 'nikto http://test.local']
            };

            const commands = categoryCommands[category];
            const outputEl = document.getElementById('main-output');
            outputEl.innerHTML = `<span class="loading">Testing ${category} commands...</span>\n\n`;

            for (const cmd of commands) {
                try {
                    const parsed = cmd.split(' ');
                    const cmdName = parsed[0];
                    const args = parsed.slice(1);

                    await registry.execute(cmdName, args, {}, {
                        terminal: terminal,
                        vfs: vfs,
                        historyManager: null,
                        cwd: vfs.getCwd(),
                        user: 'hacker',
                        hostname: 'hacksim'
                    });

                    outputEl.innerHTML += `‚úì ${cmd}\n`;
                    stats.passed++;
                } catch (error) {
                    outputEl.innerHTML += `‚úó ${cmd}: ${error.message}\n`;
                    stats.failed++;
                }
                stats.tested++;
                updateStats();
                await new Promise(resolve => setTimeout(resolve, 50));
            }

            outputEl.innerHTML += `\n‚úì ${category} tests complete\n`;
        };

        // Update statistics display
        function updateStats() {
            document.getElementById('tested-count').textContent = stats.tested;
            document.getElementById('passed-count').textContent = stats.passed;
            document.getElementById('failed-count').textContent = stats.failed;

            const successRate = stats.tested > 0
                ? ((stats.passed / stats.tested) * 100).toFixed(1)
                : 0;
            document.getElementById('success-rate').textContent = successRate + '%';
        }

        // Clear output
        window.clearOutput = function() {
            document.getElementById('main-output').innerHTML = '<span class="success">‚úì Output cleared</span>';
        };

        // Reset tests
        window.resetTests = function() {
            stats = { tested: 0, passed: 0, failed: 0 };
            updateStats();
            document.querySelectorAll('button').forEach(btn => {
                btn.classList.remove('tested', 'failed', 'loading');
            });
            document.getElementById('main-output').innerHTML = '<span class="success">‚úì Tests reset</span>';
        };

        // Initialize
        document.getElementById('start-time').textContent = new Date().toLocaleTimeString('nl-NL');
        console.log('‚úì Test suite ready');
    </script>
</body>
</html>
