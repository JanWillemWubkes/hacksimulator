export default new class{parse(s){const t=s.trim();if(!t)return{command:"",args:[],flags:{},raw:s};const e=this._tokenize(t),n=e[0].toLowerCase(),{args:r,flags:l}=this._parseTokens(e.slice(1));return{command:n,args:r,flags:l,raw:s}}_tokenize(s){const t=[];let e="",n=!1,r=null;for(let l=0;l<s.length;l++){const a=s[l];'"'!==a&&"'"!==a||n?a===r&&n?(n=!1,r=null):" "!==a||n?e+=a:e&&(t.push(e),e=""):(n=!0,r=a)}return e&&t.push(e),t}_parseTokens(s){const t=[],e={};for(let n=0;n<s.length;n++){const r=s[n];if(r.startsWith("-")&&!r.startsWith("--")){const t=r.slice(1);if(t.length>1&&!/\d/.test(t))for(const s of t)e[s]=!0;else{const r=t;1===t.length&&/[a-zA-Z]/.test(t)?e[r]=!0:n+1<s.length&&!s[n+1].startsWith("-")?(e[r]=s[n+1],n++):e[r]=!0}}else if(r.startsWith("--")){const t=r.slice(2);if(t.includes("=")){const[s,n]=t.split("=");e[s]=n}else n+1<s.length&&!s[n+1].startsWith("-")?(e[t]=s[n+1],n++):e[t]=!0}else t.push(r)}return{args:t,flags:e}}isValidCommand(s){return/^[a-z0-9-]+$/.test(s)}};