import{boxText as e}from"../../utils/asciiBox.js";export default{name:"sqlmap",category:"security",description:"SQL injection testing tool",usage:"sqlmap <url>",async execute(n,t,a){const i="true"===localStorage.getItem("security_tools_consent");if(!i&&0===n.length)return`${e("SQLMAP - Automatic SQL Injection Tool\n\nJURIDISCHE WAARSCHUWING:\nSQL injection testing zonder toestemming is ILLEGAAL.\nOngeautoriseerde toegang tot databases = strafbaar feit.\n\n  Straf: Tot 6 jaar + civiele aansprakelijkheid\n\nEDUCATIEF GEBRUIK:\nDeze simulator demonstreert SQL injection concepten veilig.\nAlle aanvallen zijn gesimuleerd.\n\nGEBRUIK:\n  sqlmap http://site.com/product?id=1\n  sqlmap http://demo-app.local/login\n  sqlmap http://test-site.com/search?q=test","SECURITY WARNING")}\n\n[?] OM DOOR TE GAAN:\n\n    Type 'sqlmap <url>' om te accepteren en door te gaan\n\n    Voorbeeld: sqlmap http://site.com/product?id=1\n\n[?] Je consent wordt opgeslagen. Type 'reset consent' om opnieuw\n      de waarschuwing te zien.`;if(!i&&n.length>0&&localStorage.setItem("security_tools_consent","true"),0===n.length)return"sqlmap: missing URL argument\n\n[?] GEBRUIK:\n   sqlmap <url>\n\n   Voorbeelden:\n   • sqlmap http://site.com/product?id=1\n   • sqlmap http://demo-app.local/login\n   • sqlmap http://test-site.com/search?q=test\n\n[?] Type 'man sqlmap' voor meer informatie.";const r=n[0];return r.startsWith("http://")||r.startsWith("https://")?r.includes("?id=")||r.includes("/product")||r.includes("/login")||r.includes("/search")?`        ___\n       __H__\n ___ ___["]_____ ___ ___  {1.7.2}\n|_ -| . [']     | .'| . |\n|___|_  [(]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[*] starting @ ${(new Date).toLocaleTimeString("nl-NL")}\n\n[12:00:01] [INFO] testing connection to target URL\n[12:00:02] [INFO] checking if the target is protected by WAF/IPS  ← Firewall check\n[12:00:03] [INFO] testing if the target URL is stable\n[12:00:04] [INFO] target URL is stable\n[12:00:05] [INFO] testing if GET parameter 'id' is injectable\n[12:00:06] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'\n[12:00:07] [INFO] testing 'MySQL >= 5.0 AND error-based'\n[12:00:08] [WARNING] reflective value(s) found  ← Parameter wordt terug getoond\n[12:00:09] [INFO] GET parameter 'id' appears to be 'MySQL >= 5.0 AND error-based' injectable\n\n[✓] **VULNERABLE!**\n\n[12:00:10] [INFO] GET parameter 'id' is injectable\n[12:00:11] [INFO] backend DBMS: MySQL 5.7.32\n[12:00:12] [INFO] fetching database names...\n\navailable databases [3]:  ← Database structuur geëxtraheerd\n[*] information_schema\n[*] shop_db\n[*] users_db\n\n[?] LEERMOMENT: Hoe werkt SQL Injection?\n\n**Normale query:**\n   SELECT * FROM products WHERE id = 1;\n\n**Geïnjecteerde query:**\n   SELECT * FROM products WHERE id = 1' OR '1'='1  ← Altijd waar!\n\nGevolg: Alle producten worden getoond (niet alleen id=1)\n\n**Erger voorbeeld (data extraction):**\n   ' UNION SELECT username, password FROM users --\n   → Haalt gebruikersnamen en wachtwoorden op!\n\n[ > ] WAT EEN AANVALLER KAN DOEN:\n   • Database structuur ophalen (tables, columns)\n   • Data lezen (credentials, persoonlijke info)\n   • Data wijzigen/verwijderen (DELETE, UPDATE)\n   • Admins accounts maken\n   • OS commands uitvoeren (met xp_cmdshell op SQL Server)\n   • Volledige server compromise\n\n[***]  BESCHERMING (voor developers):\n    - Prepared statements / parameterized queries (ALTIJD!)\n    - Input validation (whitelist approach)\n    - Escape special characters (last resort)\n    - Least privilege (database user heeft minimale rechten)\n    - WAF (Web Application Firewall)\n    - Error handling (geen database errors tonen aan user)\n\n[*] ending @ ${(new Date).toLocaleTimeString("nl-NL")}`:`        ___\n       __H__\n ___ ___[']_____ ___ ___  {1.7.2}\n|_ -| . [,]     | .'| . |\n|___|_  ["]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[*] starting @ ${(new Date).toLocaleTimeString("nl-NL")}\n\n[12:00:01] [INFO] testing connection to the target URL\n[12:00:02] [INFO] testing if the target URL is stable\n[12:00:03] [INFO] target URL appears to be stable\n[12:00:04] [INFO] testing if GET parameter 'id' is injectable\n[12:00:05] [INFO] testing 'AND boolean-based blind'\n[12:00:06] [INFO] testing 'OR boolean-based blind'\n[12:00:08] [WARNING] GET parameter does not appear to be injectable\n[12:00:09] [CRITICAL] all tested parameters do not appear to be injectable\n\n[*] ending @ ${(new Date).toLocaleTimeString("nl-NL")}\n\n[✓] GOED NIEUWS: Deze URL lijkt niet kwetsbaar voor SQL injection!\n\n[?] TIP: Probeer een URL met query parameters:\n   • http://vulnerable-site.com/product?id=1\n   • http://demo-app.local/search?q=test`:"sqlmap: invalid URL format\n\n[?] TIP: URL moet beginnen met http:// of https://\n        Bijvoorbeeld: sqlmap http://site.com/page?id=1"},manPage:'\nNAAM\n    sqlmap - Automatic SQL injection and database takeover tool\n\nSYNOPSIS\n    sqlmap <URL>\n\nBESCHRIJVING\n    SQLMap is een open source penetration testing tool die SQL injection\n    kwetsbaarheden automatisch detecteert en exploiteert. Deze simulator\n    demonstreert het concept educatief.\n\nARGUMENTEN\n    URL\n        Target URL met GET parameter (bijv. ?id=1)\n\nVOORBEELDEN\n    sqlmap http://site.com/product?id=1\n        Test \'id\' parameter voor SQL injection\n\nEDUCATIEVE CONTEXT\n    [>>>] Wat is SQL Injection?\n       Aanvaller injecteert malicious SQL code via user input.\n\n       **Kwetsbare code (PHP):**\n          $id = $_GET[\'id\'];\n          $query = "SELECT * FROM products WHERE id = $id";\n          [X] User input direct in query = GEVAARLIJK!\n\n       **Veilige code:**\n          $stmt = $pdo->prepare("SELECT * FROM products WHERE id = ?");\n          $stmt->execute([$id]);\n          [✓] Prepared statement = SQL en data gescheiden\n\n    [→] Injection types:\n       • **Error-based**: Database errors lezen voor info\n       • **Boolean-based blind**: True/False responses\n       • **Time-based blind**: Query delays (SLEEP) detecteren\n       • **Union-based**: UNION SELECT voor data extraction\n       • **Stacked queries**: Multiple queries (; DELETE...)\n\n    [?] Detection process:\n       SQLMap test automatisch:\n       1. Single quote (\') → Breekt de query?\n       2. Boolean payloads → OR 1=1, AND 1=2\n       3. Error payloads → Trigger database errors\n       4. Time delays → SLEEP(5), WAITFOR DELAY\n       5. Union payloads → UNION SELECT NULL\n\nREAL-WORLD EXAMPLES\n    [ * ] Beroemde SQL injection attacks:\n\n       **TalkTalk (2015):**\n          • 157,000 klanten data gestolen\n          • £400,000 boete van ICO\n          • £77 miljoen kosten (reputatie damage)\n\n       **Heartland Payment Systems (2008):**\n          • 130 miljoen credit card nummers\n          • $140 miljoen in settlements\n          • SQL injection in payment processing\n\n       **Sony Pictures (2011):**\n          • 77 miljoen accounts gecompromitteerd\n          • Wachtwoorden in plaintext opgeslagen\n          • Multiple SQL injection points\n\n    [?] Gemeenschappelijk patroon: Oude, ongepatched systemen\n\nEXPLOITATION CAPABILITIES\n    [ > ] Wat SQLMap kan doen (als kwetsbaarheid gevonden):\n\n    **Information gathering:**\n       • Database type en versie\n       • Current user en privileges\n       • Alle databases\n       • Alle tables en columns\n\n    **Data extraction:**\n       • Dump entire database\n       • Specific tables (users, credentials)\n       • Search for specific data\n\n    **Database takeover:**\n       • Create admin users\n       • Read/write files (LOAD_FILE, INTO OUTFILE)\n       • Execute OS commands (xp_cmdshell, sys_exec)\n\n    **Advanced:**\n       • SQL shell (interactive SQL)\n       • OS shell (full server access)\n       • Privilege escalation\n       • Pivoting naar andere systemen\n\nBESCHERMING ALS DEVELOPER\n[###] Defense in depth:\n\n    **Laag 1 - Code (KRITIEK):**\n        - Prepared statements (ALTIJD!)\n\n       PHP:\n          $stmt = $pdo->prepare("SELECT * FROM users WHERE id = ?");\n          $stmt->execute([$id]);\n\n       Node.js:\n          db.query("SELECT * FROM users WHERE id = ?", [id]);\n\n       Python:\n          cursor.execute("SELECT * FROM users WHERE id = %s", (id,))\n\n       [X] NOOIT string concatenation:\n          "SELECT * FROM users WHERE id = " + id\n\n    **Laag 2 - Input validation:**\n        - Whitelist approach (alleen expected input)\n        - Type checking (integer voor id)\n        - Length limits\n        - Regex validation\n\n    **Laag 3 - Database:**\n        - Least privilege (app user heeft ALLEEN nodige rechten)\n        - Geen xp_cmdshell/file access voor app user\n        - Separate credentials per application\n\n    **Laag 4 - Application:**\n        - Error handling (geen SQL errors naar user)\n        - Logging (detect injection attempts)\n        - Rate limiting (voorkom automated scanning)\n\n    **Laag 5 - Network:**\n        - WAF (Web Application Firewall)\n        - IDS/IPS (Intrusion Detection/Prevention)\n        - Database niet publiek toegankelijk\n\nSCANNING & TESTING\n    [?] Test je eigen applicatie:\n\n    **Manual testing:**\n       1. Voeg single quote toe: product?id=1\'\n          → Krijg je SQL error? = KWETSBAAR\n       2. Test OR 1=1: product?id=1\' OR \'1\'=\'1\n          → Zie je alle data? = KWETSBAAR\n       3. Test time delay: product?id=1\' AND SLEEP(5)--\n          → 5 seconden delay? = KWETSBAAR\n\n    **Automated (met toestemming!):**\n       • SQLMap voor comprehensive testing\n       • Burp Suite (commercial)\n       • OWASP ZAP (gratis)\n\nCOMMON MISTAKES\n    [X] **"Ik escape special characters"**\n       → Niet genoeg! Prepared statements zijn VEREIST\n       → Escaping kan bypassed worden\n\n    [X] **"Ik valideer input"**\n       → Validatie is extra laag, niet vervanging\n       → Combineer met prepared statements\n\n    [X] **"Database heeft geen gevoelige data"**\n       → SQLi kan leiden tot OS compromise\n       → Lateral movement naar andere systems\n\n    [X] **"Mijn applicatie is te klein voor aanval"**\n       → Automated scanners vinden ALLES\n       → Bots scannen continu het internet\n\nJURIDISCHE CONTEXT\n    [!]  Computer Fraud & Abuse Act / Computercriminaliteit wet:\n\n    **Illegaal:**\n       [X] SQL injection op sites zonder toestemming\n       [X] Data extraction zonder autorisatie\n       [X] System compromise\n       [X] Selling stolen data\n\n    **Legaal (met expliciete toestemming):**\n       [✓] Penetration testing (schriftelijk contract)\n       [✓] Bug bounty programs\n       [✓] Eigen applicaties testen\n       [✓] Geautoriseerde security research\n\n    Straf: Tot 6 jaar gevangenis + boetes + civiele claims\n\nGERELATEERDE COMMANDO\'S\n    nmap, nikto, metasploit, burp, hydra\n'.trim()};