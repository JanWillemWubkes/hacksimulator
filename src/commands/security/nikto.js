import{boxText as e}from"../../utils/asciiBox.js";export default{name:"nikto",category:"security",description:"Web server vulnerability scanner",usage:"nikto <url>",async execute(n,t,i){const a="true"===localStorage.getItem("security_tools_consent");if(!a&&0===n.length)return`${e("NIKTO - Web Server Vulnerability Scanner\n\nJURIDISCHE WAARSCHUWING:\nScannen van websites zonder toestemming is ILLEGAAL.\nDit wordt gezien als unauthorized access attempt.\n\n  Straf: Computercriminaliteit wet + civiele claims\n\nEDUCATIEF GEBRUIK:\nDeze simulator demonstreert web vulnerability scanning veilig.\nAlle scans zijn gesimuleerd.\n\nGEBRUIK:\n  nikto http://testsite.local\n  nikto http://vulnerable-app.com\n  nikto http://demo.example.org","SECURITY WARNING",60)}\n\n[?] OM DOOR TE GAAN:\n\n    Type 'nikto <url>' om te accepteren en door te gaan\n\n    Voorbeeld: nikto http://testsite.local\n\n[?] Je consent wordt opgeslagen. Type 'reset consent' om opnieuw\n      de waarschuwing te zien.`;if(!a&&n.length>0&&localStorage.setItem("security_tools_consent","true"),0===n.length)return"nikto: missing URL argument\n\n[?] GEBRUIK:\n   nikto <url>\n\n   Voorbeelden:\n   • nikto http://testsite.local\n   • nikto http://vulnerable-app.com\n   • nikto http://demo.example.org\n\n[?] Type 'man nikto' voor meer informatie.";const o=n[0];return o.startsWith("http://")||o.startsWith("https://")?`- Nikto v2.5.0\n---------------------------------------------------------------------------\n+ Target IP:          192.168.1.100\n+ Target Hostname:    ${o.replace(/^https?:\/\//,"").replace(/\/.*$/,"")}\n+ Target Port:        80\n+ Start Time:         ${(new Date).toLocaleString("nl-NL")}\n---------------------------------------------------------------------------\n+ Server: Apache/2.4.41 (Ubuntu)  ← Server fingerprinting\n+ The anti-clickjacking X-Frame-Options header is not present  ← Security header missing\n+ The X-Content-Type-Options header is not set  ← Security header missing\n+ No CGI Directories found (use '-C all' to force check all possible dirs)\n+ Apache/2.4.41 appears to be outdated (current is at least 2.4.54)  ← Oude versie\n+ /admin/: Directory indexing enabled  ← Sensitive directory exposed\n+ /backup/: Backup directory found  ← Mogelijk gevoelige bestanden\n+ /config.php.bak: Configuration backup file found  ← Config backup (credentials?)\n+ /phpinfo.php: PHP info page present  ← Info disclosure\n+ /test.php: Test file found  ← Development file in productie\n+ /.git/: Git repository found  ← Source code exposure!\n+ /server-status: Apache server-status enabled  ← Server info disclosure\n\n[ > ] GEVONDEN KWETSBAARHEDEN: 11\n\n[!]  KRITIEKE BEVINDINGEN:\n\n1. **Git Repository Exposed (/.git/)**\n   Severity: HIGH\n   Impact: Volledige source code kan gedownload worden\n   → Mogelijk credentials in code\n   → Mogelijke andere kwetsbaarheden in code\n\n2. **Directory Indexing Enabled (/admin/)**\n   Severity: MEDIUM\n   Impact: Aanvaller kan alle bestanden in directory zien\n   → Gevoelige admin bestanden mogelijk toegankelijk\n\n3. **Config Backup File (/config.php.bak)**\n   Severity: HIGH\n   Impact: Backup files bevatten vaak database credentials\n   → Direct database toegang mogelijk\n\n4. **Outdated Apache Version**\n   Severity: MEDIUM\n   Impact: Bekende kwetsbaarheden in oude versies\n   → Mogelijk exploiteerbaar met Metasploit\n\n5. **Security Headers Missing**\n   Severity: LOW\n   Impact: Verhoogd risico op XSS, clickjacking\n   → Makkelijkere client-side attacks\n\n+ 11 vulnerabilities found\n+ End Time: ${(new Date).toLocaleString("nl-NL")} (scan took 32 seconds)\n---------------------------------------------------------------------------\n+ 1 host(s) tested\n\n[?] LEERMOMENT: Web Security Headers\n\n**Ontbrekende headers:**\n   X-Frame-Options         → Voorkomt clickjacking\n   X-Content-Type-Options  → Voorkomt MIME type sniffing\n   Content-Security-Policy → Voorkomt XSS attacks\n   Strict-Transport-Security → Forces HTTPS\n\n[***]  REMEDIATIE STAPPEN:\n\n1. **Verwijder development files:**\n   rm /var/www/html/phpinfo.php\n   rm /var/www/html/test.php\n\n2. **Block .git directory:**\n   <Directory ".git">\n       Require all denied\n   </Directory>\n\n3. **Disable directory indexing:**\n   Options -Indexes\n\n4. **Update Apache:**\n   apt update && apt upgrade apache2\n\n5. **Add security headers (Apache):**\n   Header always set X-Frame-Options "DENY"\n   Header always set X-Content-Type-Options "nosniff"\n   Header always set Content-Security-Policy "default-src 'self'"\n\n6. **Remove backup files:**\n   find . -name "*.bak" -delete\n\n[!]  PRIORITEIT: Fix HIGH severity issues eerst!`:"nikto: invalid URL format\n\n[?] TIP: URL moet http:// of https:// bevatten\n        Bijvoorbeeld: nikto http://example.com"},manPage:'\nNAAM\n    nikto - Web server vulnerability scanner\n\nSYNOPSIS\n    nikto <URL>\n\nBESCHRIJVING\n    Nikto is een open source web server scanner die 6700+ potentieel\n    gevaarlijke files/programs test, oude versies detecteert en\n    server configuratie problemen vindt.\n\nARGUMENTEN\n    URL\n        Target website (http:// of https://)\n\nVOORBEELDEN\n    nikto http://example.com\n        Scan website voor kwetsbaarheden\n\nEDUCATIEVE CONTEXT\n    [?] Wat scant Nikto?\n       • Oude software versies (Apache, nginx, IIS)\n       • Gevaarlijke files (phpinfo, test files, backups)\n       • Server misconfiguratie (directory indexing)\n       • Security headers (of gebrek daaraan)\n       • Default files (admin panels, install scripts)\n       • Bekende kwetsbaarheden (via database)\n\n    [→] Vulnerability types:\n       • **Info disclosure**: phpinfo.php, .git/, server-status\n       • **Outdated software**: Oude Apache/PHP met bekende CVEs\n       • **Misconfigurations**: Directory indexing, backup files\n       • **Missing security headers**: CSP, HSTS, X-Frame-Options\n       • **Default installs**: Admin panels op default locations\n\nCOMMON FINDINGS\n    [DIR] Development Files in Production:\n       • phpinfo.php → PHP configuration details\n       • test.php → Mogelijk SQL injection test code\n       • debug.php → Error messages, stack traces\n       → IMPACT: Information disclosure, mogelijk RCE\n\n    [IDX]️  Backup Files:\n       • config.php.bak → Database credentials\n       • .env.backup → API keys, secrets\n       • database.sql → Volledige database dump\n       → IMPACT: Direct toegang tot credentials/data\n\n    [DIR] Version Control Exposed:\n       • .git/ → Volledige source code + history\n       • .svn/ → Subversion repository\n       • .DS_Store → Mac OS metadata (directory listing)\n       → IMPACT: Source code theft, hardcoded secrets\n\n    [ > ] Directory Indexing:\n       • /uploads/ → User uploaded files zichtbaar\n       • /admin/ → Admin panel files\n       • /backup/ → Backup files\n       → IMPACT: Sensitive data exposure\n\nSECURITY HEADERS\n    [***]  Essentiële headers:\n\n    **X-Frame-Options:**\n       Voorkomt clickjacking (iframe embedding)\n       Value: DENY of SAMEORIGIN\n\n    **Content-Security-Policy (CSP):**\n       Voorkomt XSS attacks\n       Value: default-src \'self\'; script-src \'self\'\n\n    **Strict-Transport-Security (HSTS):**\n       Forceert HTTPS\n       Value: max-age=31536000; includeSubDomains\n\n    **X-Content-Type-Options:**\n       Voorkomt MIME sniffing\n       Value: nosniff\n\n    **Referrer-Policy:**\n       Controleert hoeveel referrer info verstuurd wordt\n       Value: strict-origin-when-cross-origin\n\nREAL-WORLD EXAMPLES\n    [ * ] Git Repository Exposure:\n       • Uber (2016): .git/ exposed in web root\n       • Source code downloaded door security researcher\n       • AWS credentials gevonden in code\n       • $3 miljoen data breach resultaat\n\n    [ * ] phpinfo() Exposure:\n       • Talloze sites laten phpinfo.php online staan\n       • Toont: File paths, extensions, environment vars\n       • Helpt aanvaller met reconnaissance\n       • Vaak eerste stap in attack chain\n\nREMEDIATION\n    [CFG] Quick fixes:\n\n    **1. Remove dangerous files:**\n       find /var/www -name "phpinfo.php" -delete\n       find /var/www -name "test.php" -delete\n       find /var/www -name "*.bak" -delete\n\n    **2. Block version control:**\n       # Apache\n       <DirectoryMatch "^\\.git">\n           Require all denied\n       </DirectoryMatch>\n\n       # Nginx\n       location ~ /\\.git {\n           deny all;\n       }\n\n    **3. Disable directory indexing:**\n       # Apache\n       Options -Indexes\n\n       # Nginx\n       autoindex off;\n\n    **4. Add security headers (Apache):**\n       Header set X-Frame-Options "DENY"\n       Header set X-Content-Type-Options "nosniff"\n       Header set Content-Security-Policy "default-src \'self\'"\n       Header set Strict-Transport-Security "max-age=31536000"\n\n    **5. Update software:**\n       apt update && apt upgrade  # Debian/Ubuntu\n       yum update                 # CentOS/RHEL\n\nAUTOMATED SCANNING\n    [BOT] CI/CD Integration:\n       Nikto kan geautomatiseerd draaien in CI/CD pipeline:\n\n       # GitLab CI\n       nikto-scan:\n         script:\n           • nikto -h https://staging.example.com -o report.html\n\n       → Catch vulnerabilities VOOR production deploy\n\nDEFENSE IN DEPTH\n    [***]  Layered security:\n\n    **Layer 1 - Server hardening:**\n        - Remove default files/folders\n        - Disable directory indexing\n        - Update software regelmatig\n        - Minimal installed packages\n\n    **Layer 2 - Web Application Firewall:**\n        - ModSecurity (Apache/Nginx)\n        - Cloudflare WAF\n        - AWS WAF\n       → Block common attack patterns\n\n    **Layer 3 - Security headers:**\n        - CSP, HSTS, X-Frame-Options\n        - Check: securityheaders.com\n\n    **Layer 4 - Monitoring:**\n        - Log analysis (fail2ban)\n        - SIEM integration\n        - Anomaly detection\n\nLIMITATIONS\n    [!]  Wat Nikto NIET doet:\n       • Geen exploit execution (alleen detectie)\n       • Geen SQL injection testing (gebruik sqlmap)\n       • Geen XSS testing (gebruik Burp/ZAP)\n       • Geen authenticated scanning (alleen public)\n\n    Nikto is RECON tool, niet exploit tool.\n\nLEGAL USE\n    [✓] Authorized testing:\n       • Eigen websites\n       • Penetration testing contract\n       • Bug bounty programs (within scope)\n       • Security audits\n\n    [X] Unauthorized scanning:\n       • Random websites scannen\n       • Concurrenten scannen\n       • Zonder expliciete toestemming\n\n    Straf: Computer Fraud Act violations, civiele claims\n\nGERELATEERDE COMMANDO\'S\n    nmap (port scanning), sqlmap (SQL injection), wpscan (WordPress)\n'.trim()};