import{boxText as e}from"../../utils/asciiBox.js";const n={"ssh://192.168.1.100":{service:"SSH",port:22,credentials:[{user:"admin",pass:"admin"},{user:"root",pass:"123456"},{user:"user",pass:"password"}],attempts:47},"ftp://192.168.1.50":{service:"FTP",port:21,credentials:[{user:"anonymous",pass:"guest"},{user:"admin",pass:"admin123"}],attempts:23},"http://target.local/admin":{service:"HTTP-POST",port:80,credentials:[{user:"admin",pass:"admin"}],attempts:15}};export default{name:"hydra",category:"security",description:"Network logon brute force tool",usage:"hydra <target>",async execute(t,r,a){const o="true"===localStorage.getItem("security_tools_consent");if(!o&&0===t.length)return`${e('HYDRA - Network Logon Brute Force Tool\n\nJURIDISCHE WAARSCHUWING:\nBrute force aanvallen zonder toestemming zijn ILLEGAAL.\nDit is een strafbaar feit onder de Computercriminaliteit wet.\n\n  Straf: Tot 6 jaar gevangenisstraf\n\nEDUCATIEF GEBRUIK:\nDeze simulator demonstreert brute force concepten veilig.\nAlle "aanvallen" zijn gesimuleerd.\n\nGEBRUIK:\n  hydra ssh://192.168.1.100     (SSH brute force)\n  hydra ftp://192.168.1.50      (FTP brute force)\n  hydra http://target.local/admin  (HTTP brute force)',"SECURITY WARNING",60)}\n\n[ ? ] OM DOOR TE GAAN:\n\n    Type 'hydra <target>' om te accepteren en door te gaan\n\n    Voorbeeld: hydra ssh://192.168.1.100\n\n[ ? ] Je consent wordt opgeslagen. Type 'reset consent' om opnieuw\n      de waarschuwing te zien.`;if(!o&&t.length>0&&localStorage.setItem("security_tools_consent","true"),0===t.length)return"hydra: missing target argument\n\n[ ? ] GEBRUIK:\n   hydra <target>\n\n   Voorbeelden:\n   • hydra ssh://192.168.1.100\n   • hydra ftp://192.168.1.50\n   • hydra http://target.local/admin\n\n[ ? ] Type 'man hydra' voor meer informatie.";const s=t[0];if(!s.startsWith("ssh://")&&!s.startsWith("ftp://")&&!s.startsWith("http://"))return"hydra: invalid target format\n\n[ ? ] TIP: Target moet protocol bevatten. Gebruik:\n   • ssh://192.168.1.100\n   • ftp://192.168.1.50\n   • http://target.local/admin";const i=n[s];if(!i)return`Hydra v9.5 starting...\n\n[INFO] Resolving target: ${s}\n[ERROR] Target not found in demo database\n\n[ ? ] TIP: Deze simulator heeft beperkte demo targets:\n   • ssh://192.168.1.100 (SSH server met zwakke credentials)\n   • ftp://192.168.1.50 (FTP server)\n   • http://target.local/admin (Web admin panel)\n\n[ ! ]  In echte scenario's:\n    • Hydra ondersteunt 50+ protocols\n    • Custom wordlists met miljoenen passwords\n    • Multi-threaded (snelheid)\n    • Vaak geblokkeerd door rate limiting of firewalls`;const{service:d,port:l,credentials:c,attempts:g}=i,m=c[0];return`Hydra v9.5 (c) 2023 by van Hauser/THC - Use with authorization only!\n\nHydra (https://github.com/vanhauser-thc/thc-hydra)\nStarting at ${(new Date).toLocaleTimeString("nl-NL")}\n\n[INFO] Resolving ${s}... done\n[DATA] attacking ${d} on port ${l}  ← Service identificatie\n[STATUS] Loading wordlist... common_passwords.txt\n[STATUS] ${g} login attempts to test\n\nBrute forcing credentials...\n\n[ATTEMPT] [${d}] host: ${s} login: root password: toor\n[ATTEMPT] [${d}] host: ${s} login: root password: password\n[ATTEMPT] [${d}] host: ${s} login: admin password: 12345\n${".".repeat(40)}\n[ATTEMPT] [${d}] host: ${s} login: ${m.user} password: ${m.pass}\n\n[${l}][${d}] host: ${s}\n   login: ${m.user}     ← Username gevonden!\n   password: ${m.pass}  ← Password gekraakt!\n\n[STATUS] attack finished for ${s}\n\n1 of 1 target successfully completed, 1 valid password found\n\n[ ? ] WAAROM WERKTE DIT?\n\n1. **Zwakke credentials**: "${m.user}:${m.pass}" is voorspelbaar\n2. **Geen rate limiting**: Server blokkeert niet na failed attempts\n3. **Geen account lockout**: Account blijft beschikbaar na 100+ fouten\n4. **Default credentials**: Veel devices komen met admin:admin\n5. **Snelheid**: Hydra probeert 16 passwords per seconde (of meer)\n\n[***]  BESCHERMING:\n   [ ✓ ] Sterke, unieke wachtwoorden (min 16 karakters)\n   [ ✓ ] Rate limiting (max 3 pogingen per 5 minuten)\n   [ ✓ ] Account lockout (na 5 foute pogingen)\n   [ ✓ ] 2FA/MFA (brute force wordt nutteloos)\n   [ ✓ ] Fail2ban (auto-block na x pogingen)\n   [ ✓ ] Verander default credentials ALTIJD!`},manPage:"\nNAAM\n    hydra - Network logon brute force tool\n\nSYNOPSIS\n    hydra <TARGET>\n\nBESCHRIJVING\n    THC-Hydra is een network logon cracker die brute force aanvallen\n    uitvoert op diverse protocols. Deze simulator demonstreert het\n    concept op een veilige, educatieve manier.\n\nARGUMENTEN\n    TARGET\n        Target in format: protocol://host[:port]\n        Voorbeelden: ssh://192.168.1.100, ftp://target.com\n\nVOORBEELDEN\n    hydra ssh://192.168.1.100\n        Brute force SSH login (demo)\n\n    hydra ftp://192.168.1.50\n        Brute force FTP login (demo)\n\nEDUCATIEVE CONTEXT\n    [ → ] Wat is brute force?\n       Systematisch alle mogelijke passwords proberen tot je de juiste vindt.\n\n       Voorbeeld flow:\n       1. Try: admin:password → FAIL\n       2. Try: admin:123456 → FAIL\n       3. Try: admin:admin → SUCCESS!\n\n    [ ~ ] Waarom werkt dit (soms)?\n       • Mensen gebruiken zwakke passwords (admin, password, 123456)\n       • Default credentials niet veranderd (IoT devices!)\n       • Geen bescherming tegen automated attacks\n       • Services zijn snel (honderden pogingen per seconde mogelijk)\n\n    [###]  Waarom werkt dit NIET (als goed beveiligd)?\n       • Rate limiting: Max 3 pogingen per 5 min\n       • Account lockout: Account geblokkeerd na 5 fouten\n       • 2FA/MFA: Wachtwoord alleen is niet genoeg\n       • CAPTCHA: Voorkomt geautomatiseerde aanvallen\n       • IP blocking: Fail2ban blokkeert IP na x pogingen\n       • Strong passwords: 16+ chars = miljarden jaren om te kraken\n\nSUPPORTED PROTOCOLS (in echte Hydra)\n    [ ~ ] 50+ protocols, waaronder:\n       • SSH, FTP, Telnet\n       • HTTP(S) - forms, basic auth, digest auth\n       • SMB, RDP (Windows remote desktop)\n       • MySQL, PostgreSQL, MongoDB\n       • IMAP, POP3, SMTP (email)\n       • VNC, LDAP, Redis\n       • En nog veel meer...\n\nATTACK MODES\n    [ = ] Wordlist attack:\n       hydra -L users.txt -P passwords.txt ssh://target\n       → Probeer elke user/pass combinatie uit lijsten\n\n    [###] Brute force:\n       hydra -l admin -x 4:6:a ssh://target\n       → Genereer alle combinaties (4-6 chars, letters only)\n\n    [ > ] Single credential:\n       hydra -l admin -p admin123 ssh://target\n       → Test specifieke credentials (verification)\n\nREAL-WORLD USE CASES\n    [ ✓ ] Legitiem gebruik:\n       • Penetration testing (met contract)\n       • Password strength audit (eigen systemen)\n       • Forensische analyse (met warrant)\n       • Security research (ethisch)\n\n    [ X ] Illegaal gebruik:\n       • Unauthorized access proberen\n       • Credential stuffing attacks\n       • Botnet spreiding\n       • Account takeovers\n\n    Straf: Tot 6 jaar gevangenisstraf + hoge boetes\n\nFAMOUS EXAMPLES\n    [ * ] IoT Botnet Attacks:\n       • Mirai botnet (2016): Infecteerde 600,000+ IoT devices\n         → Gebruikte lijst van 60 default credentials\n         → Massive DDoS attacks (1 Tbps)\n         → Target: Dyn DNS provider (half internet down)\n\n       Devices met default credentials:\n       • IP cameras: admin:admin\n       • Routers: admin:password\n       • DVRs: admin:12345\n\n    [ ? ] Leermoment: Miljoenen IoT devices NOOIT credentials veranderen!\n\nBESCHERMING ALS SYSTEEMBEHEERDER\n[###] Defense in depth:\n\n    Laag 1 - Credentials:\n        - Verplicht sterke passwords (min 16 chars)\n        - Geen default credentials (force change on first login)\n        - Password complexity requirements\n\n    Laag 2 - Rate limiting:\n        - Max 3-5 pogingen per 5 minuten\n        - Exponential backoff (1s, 2s, 4s, 8s...)\n        - CAPTCHA na 3 fouten\n\n    Laag 3 - Account security:\n        - Account lockout na 5 foute pogingen\n        - Email notificatie bij failed logins\n        - 2FA/MFA verplicht (voor admin accounts)\n\n    Laag 4 - Network security:\n        - Fail2ban (auto-block IP na x pogingen)\n        - Firewall rules (whitelist IPs voor SSH)\n        - VPN required voor remote access\n        - Port knocking (verberg services)\n\n    Laag 5 - Monitoring:\n        - Log alle login pogingen\n        - Alerts bij brute force patterns\n        - SIEM integration (Security Information and Event Management)\n\nBESCHERMING ALS GEBRUIKER\n[###] Best practices:\n       [ ✓ ] Password manager (unieke passwords per service)\n       [ ✓ ] 16+ karakter passwords met speciale tekens\n       [ ✓ ] 2FA ALTIJD inschakelen (authenticator app)\n       [ ✓ ] Geen password reuse (credential stuffing preventie)\n       [ ✓ ] Verander default credentials onmiddellijk\n\n    [ X ] NOOIT doen:\n       [ X ] password, admin, 123456, qwerty\n       [ X ] Zelfde wachtwoord op meerdere sites\n       [ X ] Wachtwoorden delen of opschrijven\n\nTECHNICAL DETAILS\n    [ ~ ]  Hoe Hydra werkt:\n       1. Connect naar service (SSH/FTP/HTTP/etc)\n       2. Try credentials from wordlist\n       3. Parse response (success/fail)\n       4. Repeat with next credential\n       5. Multi-threaded (16 connections parallel)\n\n    [ ~ ] Speed:\n       • SSH: ~16 attempts/sec (handshake overhead)\n       • HTTP: ~100 attempts/sec (sneller protocol)\n       • FTP: ~50 attempts/sec\n       • Snelheid hangt af van:\n         • Network latency\n         • Server response time\n         • Rate limiting\n\nCOUNTERMEASURES DETECTION\n    [ ? ] Herken brute force aanvallen:\n       • Vele failed logins in korte tijd\n       • Van zelfde IP adres\n       • Verschillende usernames/passwords\n       • Predictable patterns (alphabetical wordlist)\n\n    Voorbeeld log:\n       2025-10-15 12:00:01 Failed password for admin from 1.2.3.4\n       2025-10-15 12:00:02 Failed password for root from 1.2.3.4\n       2025-10-15 12:00:03 Failed password for user from 1.2.3.4\n       → ALERT: Possible brute force from 1.2.3.4\n\nGERELATEERDE COMMANDO'S\n    hashcat, metasploit, nmap, john (the ripper)\n".trim()};