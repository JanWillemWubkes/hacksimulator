export default{name:"nmap",category:"network",description:"Network port scanner",usage:"nmap <target>",async execute(e,n,r){if(0===e.length)return"nmap: missing target operand\n\n[ ? ] TIP: Gebruik 'nmap <target>' om poorten te scannen. Bijvoorbeeld: nmap 192.168.1.100";const o=e[0],t=function(e){const n={openPorts:[{port:22,service:"SSH",info:"OpenSSH 8.2"},{port:80,service:"HTTP",info:"nginx 1.18.0"},{port:443,service:"HTTPS",info:"nginx 1.18.0"}],closedCount:997};return"localhost"===e||"127.0.0.1"===e?{openPorts:[{port:22,service:"SSH",info:"OpenSSH 8.2"},{port:80,service:"HTTP",info:"Apache 2.4.46"},{port:3e3,service:"HTTP",info:"Node.js dev server"},{port:5432,service:"PostgreSQL",info:"PostgreSQL 13"},{port:8080,service:"HTTP-PROXY",info:"development"}],closedCount:995}:e.includes("192.168.1.1")?{openPorts:[{port:53,service:"DNS",info:"dnsmasq"},{port:80,service:"HTTP",info:"router admin"},{port:443,service:"HTTPS",info:"router admin"}],closedCount:997}:e.includes("192.168.1")?n:e.includes("database")||e.includes("db")?{openPorts:[{port:22,service:"SSH",info:"OpenSSH 8.2"},{port:3306,service:"MySQL",info:"MySQL 8.0.25"},{port:5432,service:"PostgreSQL",info:"PostgreSQL 13.3"}],closedCount:997}:e.includes("secure")||e.includes("hardened")?{openPorts:[{port:443,service:"HTTPS",info:"nginx 1.20.0"}],closedCount:999,filtered:[22,80]}:n}(o);let a=`Starting Nmap scan on ${o}...\n`;a+=`Nmap scan report for ${o}\n`,t.filtered&&t.filtered.length>0&&(a+="\nFiltered ports (firewall):\n",t.filtered.forEach(e=>{a+=`${e}/tcp  FILTERED\n`})),a+="\nPORT      STATE   SERVICE        VERSION\n",t.openPorts.forEach(({port:e,service:n,info:r})=>{const o=`${e}/tcp`.padEnd(10),t="OPEN".padEnd(8),s=n.padEnd(15);let i="";22===e?i="  ← SSH: Secure remote access":80===e?i="  ← HTTP: Webserver (unencrypted)":443===e?i="  ← HTTPS: Secure webserver":3306===e?i="  ← MySQL: Database server":5432===e?i="  ← PostgreSQL: Database":53===e&&(i="  ← DNS: Name resolution"),a+=`${o}${t}${s}${r}${i}\n`});const s=t.openPorts.length,i=t.filtered?t.filtered.length:0;return a+="\nNmap done: 1 IP address (1 host up) scanned\n",a+=`Port summary: ${s} open, ${1e3-s-i} closed, ${i} filtered`,1===s&&443===t.openPorts[0].port?a+="\n\n[ ? ] TIP: Deze server is goed beveiligd! Alleen HTTPS open = minimale attack surface.":s>=5?a+="\n\n[ ? ] TIP: Veel open poorten = meer aanvalsvectoren. Elke service kan kwetsbaarheden hebben.":t.openPorts.some(e=>22===e.port)?a+="\n\n[ ? ] TIP: SSH (22) open = je kunt inloggen proberen. Probeer 'hydra' voor brute force (demo).":a+="\n\n[ ? ] TIP: Open poorten zijn entry points. Pentester checkt elke service op kwetsbaarheden.",t.openPorts.some(e=>3306===e.port||5432===e.port)&&(a+="\n\n[ ! ]  SECURITY: Database poort open naar buiten = risico! Zou restricted moeten zijn."),a},manPage:'\nNAAM\n    nmap - Network port scanner\n\nSYNOPSIS\n    nmap <TARGET>\n\nBESCHRIJVING\n    Nmap ("Network Mapper") is de industrie-standaard tool voor network\n    discovery en security auditing. Deze simulator toont een vereenvoudigde\n    versie die de top 1000 meest voorkomende poorten scant.\n\nARGUMENTEN\n    TARGET\n        IP adres of hostname om te scannen\n        Voorbeelden: 192.168.1.100, localhost, database.local\n\nVOORBEELDEN\n    nmap 192.168.1.100\n        Scan een machine op je lokale netwerk\n\n    nmap localhost\n        Scan je eigen machine (development ports)\n\n    nmap 192.168.1.1\n        Scan je router\n\nUITLEG OUTPUT\n    • PORT       → Poortnummer en protocol (meestal TCP)\n    • STATE      → OPEN (bereikbaar), CLOSED (niet open), FILTERED (firewall)\n    • SERVICE    → Welke service draait typisch op deze poort\n    • VERSION    → Versie van de software (service detection)\n\nEDUCATIEVE TIPS\n    [ → ] Waarom port scanning?\n       • Host discovery: Welke machines zijn online?\n       • Service discovery: Welke services draaien er?\n       • Vulnerability assessment: Oude versies = kwetsbaarheden\n       • Attack surface mapping: Hoe groot is het aanvalsoppervlak?\n\n    [ > ] Veelvoorkomende poorten:\n       • 22   → SSH (remote terminal access)\n       • 80   → HTTP (webserver, unencrypted)\n       • 443  → HTTPS (webserver, encrypted)\n       • 21   → FTP (file transfer, oude protocol)\n       • 23   → Telnet (remote access, ZEER onveilig)\n       • 25   → SMTP (email server)\n       • 3306 → MySQL (database)\n       • 5432 → PostgreSQL (database)\n       • 8080 → HTTP alternate (development servers)\n\n    [###]  Security interpretatie:\n       • Weinig open poorten (1-3) = Goed! Minimale attack surface\n       • Veel open poorten (>10) = Slecht! Meer aanvalsvectoren\n       • Database poorten open = RISICO! Zouden restricted moeten zijn\n       • Filtered poorten = Firewall aanwezig (goed teken)\n\n    [ ! ]  Ethische waarschuwing:\n       Port scanning zonder toestemming is in veel landen ILLEGAAL.\n       Dit wordt gezien als voorbereiding op een aanval.\n       • Eigen netwerk scannen? → OK\n       • Netwerk van je werk (met toestemming)? → OK\n       • Willekeurige servers op internet? → ILLEGAAL!\n\n    [ ? ] Pentesting workflow:\n       1. nmap voor port discovery\n       2. Service versies identificeren\n       3. Zoeken naar known vulnerabilities (CVE database)\n       4. Testen met exploits (metasploit, custom scripts)\n\n    [ ? ] Geavanceerde scans (niet in simulator):\n       • -sV  → Service version detection\n       • -A   → Aggressive scan (OS detection, traceroute)\n       • -p-  → Scan ALLE 65535 poorten (traag!)\n       • -sS  → SYN scan (stealth, geen volledige TCP handshake)\n       • -O   → OS fingerprinting\n\nPRAKTISCH GEBRUIK\n    [ # ] Thuis netwerk:\n       nmap 192.168.1.0/24  → Scan hele thuisnetwerk (alle 254 IPs)\n\n    [CPU] Development:\n       nmap localhost → Check welke dev servers draaien\n\n    [ ! ] Security audit:\n       • Scan je eigen server vanaf buiten\n       • Check of alleen essentiële poorten open zijn\n       • Database poorten (3306, 5432) NOOIT naar internet!\n\nVEELGEMAAKTE FOUTEN\n    [ X ] nmap (zonder target)\n       → Je moet een target opgeven\n\n    [ X ] nmap google.com (zonder toestemming)\n       → ILLEGAAL! Scan alleen je eigen systemen\n\n    [ X ] Te veel vertrouwen op firewall\n       → "Filtered" betekent niet "veilig" - service kan alsnog kwetsbaar zijn\n\n[###] SECURITY BEST PRACTICES\n    [ ✓ ] Minimaliseer open poorten (alleen wat noodzakelijk is)\n    [ ✓ ] Database poorten ALLEEN toegankelijk voor app servers\n    [ ✓ ] SSH op non-standard port (security through obscurity - beperkt effectief)\n    [ ✓ ] Firewall rules: whitelist approach (allow only what\'s needed)\n    [ ✓ ] Regelmatig scannen van je eigen infrastructure\n\nGERELATEERDE COMMANDO\'S\n    ping, netstat, traceroute, nikto (web vulnerability scanner)\n'.trim()};