export default{name:"traceroute",category:"network",description:"Trace network path to destination",usage:"traceroute <destination>",async execute(e,n,t){if(0===e.length)return"traceroute: missing destination operand\n\n[ ? ] TIP: Gebruik 'traceroute <host>' om route te tracen. Bijvoorbeeld: traceroute google.com";const o=e[0],r=function(e){const n={"google.com":[{hop:1,ip:"192.168.1.1",hostname:"router.local",time:[1,1,1]},{hop:2,ip:"10.0.0.1",hostname:"gateway.isp.net",time:[8,9,8]},{hop:3,ip:"81.206.165.1",hostname:"core1.isp.net",time:[12,11,13]},{hop:4,ip:"72.14.238.10",hostname:"edge.google.net",time:[15,16,14]},{hop:5,ip:"142.250.185.46",hostname:"google.com",time:[16,15,16]}],localhost:[{hop:1,ip:"127.0.0.1",hostname:"localhost",time:[0,0,0]}],"8.8.8.8":[{hop:1,ip:"192.168.1.1",hostname:"router.local",time:[1,1,2]},{hop:2,ip:"10.0.0.1",hostname:"gateway.isp.net",time:[7,8,9]},{hop:3,ip:"81.206.165.1",hostname:"core1.isp.net",time:[11,12,11]},{hop:4,ip:"8.8.8.8",hostname:"dns.google",time:[13,12,14]}],"github.com":[{hop:1,ip:"192.168.1.1",hostname:"router.local",time:[2,1,2]},{hop:2,ip:"10.0.0.1",hostname:"gateway.isp.net",time:[9,10,9]},{hop:3,ip:"81.206.165.1",hostname:"core1.isp.net",time:[14,13,15]},{hop:4,ip:"*",hostname:null,time:["*","*","*"]},{hop:5,ip:"140.82.121.3",hostname:"github.com",time:[22,21,23]}]};return n[e.toLowerCase()]||n["google.com"]}(o);let a=`traceroute to ${o}, 30 hops max\n\n`;if(r.forEach(({hop:e,ip:n,hostname:t,time:o})=>{const r=`${e}`.padStart(2);if("*"===n)a+=` ${r}  * * *  ← Hop filtered (firewall/router config)\n`;else{const e=t?`${t} (${n})`:n,i=o.map(e=>`${e}ms`).join("  ");a+=` ${r}  ${e}  ${i}\n`}}),"localhost"===o||"127.0.0.1"===o)a+="\n[ ? ] TIP: localhost = 0 hops, geen netwerk nodig (loopback interface).";else if(r.some(e=>"*"===e.ip))a+="\n[ ? ] TIP: * betekent hop antwoordt niet (firewall, of ICMP blocked).";else{const e=r.length;a+=`\n[ ? ] TIP: ${e} hops = aantal routers tussen jou en bestemming. Meer hops = langere route.`}return a},manPage:'\nNAAM\n    traceroute - trace network path to destination\n\nSYNOPSIS\n    traceroute <DESTINATION>\n\nBESCHRIJVING\n    Toont de route die packets nemen van je machine naar de bestemming.\n    Elke "hop" is een router op het pad. Useful voor netwerk diagnostics\n    en understanding network topology.\n\nARGUMENTEN\n    DESTINATION\n        IP adres of hostname van bestemming\n        Voorbeelden: google.com, 8.8.8.8, github.com\n\nVOORBEELDEN\n    traceroute google.com\n        Trace route naar Google\'s servers\n\n    traceroute 8.8.8.8\n        Trace route naar Google DNS (reliable test)\n\n    traceroute localhost\n        Trace naar je eigen machine (0 hops)\n\nUITLEG OUTPUT\n    [###] Kolommen:\n       • Hop nummer    → Positie in route (1 = eerste router)\n       • Hostname/IP   → Identificatie van router\n       • Time (3x)     → Round-trip time voor 3 test packets (ms)\n\n    [ ! ]  Special cases:\n       • * * *         → Hop antwoordt niet (ICMP filtered/blocked)\n       • !H            → Host unreachable\n       • !N            → Network unreachable\n\nEDUCATIEVE TIPS\n    [ @ ] Hoe werkt traceroute?\n       • Stuurt packets met oplopende TTL (Time To Live)\n       • TTL=1 → Eerste router reageert (expired)\n       • TTL=2 → Tweede router reageert\n       • Etc. tot bestemming bereikt is\n\n    [ · ] Route analyse:\n       • Hop 1 is meestal je router (192.168.x.x)\n       • Hop 2-3 zijn vaak ISP routers\n       • Daarna internet backbone\n       • Laatste hop is destination\n\n    [ ~ ] Performance insights:\n       • Grote tijd sprong (10ms → 100ms) = lange afstand of congestion\n       • Hoge latency op vroege hop = probleem dichtbij\n       • Hoge latency alleen op laatste hop = probleem bij destination\n\n    [ ! ] Security / Privacy:\n       • Veel bedrijven blokkeren ICMP = * * * hops\n       • Geographic location kan afgeleid worden (IP ranges)\n       • Traceroute gebruikt voor network mapping (recon)\n\n    [ → ] In pentesting:\n       • Netwerk topologie ontdekken\n       • Firewalls identificeren (waar beginnen * hops?)\n       • Routing paths begrijpen (voor man-in-the-middle)\n       • Geographic location bepalen\n\nPRAKTISCHE VOORBEELDEN\n    [ ? ] Netwerk troubleshooting:\n       Langzame verbinding? Check waar vertraging zit:\n\n       traceroute slow-site.com\n       → Hop 5: 200ms (probleem zit hier!)\n       → Contact je ISP of probeer andere route\n\n    [ @ ] Geographic routing:\n       traceroute european-site.eu\n       → Veel hops in Europa\n       traceroute us-site.com\n       → Hops springen Atlantische oceaan over (submarine cables!)\n\n    [###]  Firewall detection:\n       traceroute corporate-site.com\n       → Hop 1-5: normaal\n       → Hop 6-10: * * * (firewall blocks ICMP)\n       → Hop 11: destination (past firewall)\n\nVEELGEMAAKTE FOUTEN\n    [ X ] Veel * * * hops (geen response)\n       → Niet altijd een probleem! Routers mogen ICMP blokkeren\n       → Als destination bereikbaar is (ping werkt) = OK\n\n    [ X ] Route lijkt inefficiënt (veel hops, of omweg)\n       → Internet routing is complex (BGP policies)\n       → Route kan dynamisch veranderen (load balancing)\n\n    [ X ] Laatste hop timeout maar site werkt\n       → Destination server blokkeert ICMP maar accepteert HTTP\n       → Dit is normaal voor security-conscious servers\n\nTECHNICAL DETAILS\n    [CFG] Implementatie varianten:\n       • Linux: traceroute (gebruikt UDP)\n       • Windows: tracert (gebruikt ICMP)\n       • Resultaten kunnen verschillen (firewalls behandelen UDP/ICMP anders)\n\n    [ @ ] TTL (Time To Live):\n       • Start bijvoorbeeld bij 1\n       • Elke router verlaagt TTL met 1\n       • TTL=0 → Router stuurt "Time Exceeded" terug\n       • Dit is hoe traceroute hop-by-hop ontdekt\n\n    [CHT] Waarom 3 packets per hop?\n       • Gemiddelde berekenen (routes kunnen variëren)\n       • Packet loss detecteren (1 lost packet = OK)\n       • Meer betrouwbare timing meting\n\nGEAVANCEERDE USE\n    -I    → Gebruik ICMP i.p.v. UDP (kan meer success hebben)\n    -T    → Gebruik TCP packets (vaak niet geblokkeerd)\n    -p    → Specify destination port\n    -m    → Max hops (default 30)\n    -q    → Aantal packets per hop (default 3)\n\nGERELATEERDE COMMANDO\'S\n    ping, nmap, mtr (combines ping + traceroute)\n'.trim()};