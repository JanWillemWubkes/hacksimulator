import{getPathCompletions as e}from"../../utils/filesystem-completion.js";export default{name:"rm",category:"filesystem",description:"Remove files or directories",usage:"rm [options] <file>",completionProvider(r){const n=r.length>0?r[r.length-1]:"";return e(n,{type:"both"})},async execute(e,r,n){const{vfs:t}=n;if(0===e.length)return"rm: missing operand\n\n[ ? ] TIP: Gebruik 'rm <bestand>' om een bestand te verwijderen. Gebruik 'rm -r <directory>' voor directories.";const i=e[0],s=r.r||r.R||r.recursive||!1;if(function(e){const r=(e.startsWith("/"),e);return["/","/etc","/var","/home","/root","/bin","/usr"].includes(r)}(i))return`rm: cannot remove '${i}': Critical system directory\n\n[ ! ] WAARSCHUWING: Dit is een kritieke system directory. In een echte omgeving zou dit je systeem onbruikbaar maken!\n\n[ ? ] TIP: Gebruik 'reset' om het filesystem te resetten naar de beginwaarde.`;try{return t.delete(i,s),""}catch(e){return e.message.includes("No such file or directory")?`rm: cannot remove '${i}': No such file or directory\n\n[ ? ] TIP: Gebruik 'ls' om te zien welke bestanden beschikbaar zijn.`:e.message.includes("Directory not empty")?`rm: cannot remove '${i}': Directory not empty\n\n[ ? ] TIP: Gebruik 'rm -r ${i}' om een directory inclusief inhoud te verwijderen.\n\n[ ! ] Let op: rm -r verwijdert recursief alles in de directory!`:e.message.includes("Cannot delete root")?"rm: cannot remove '/': Cannot delete root directory\n\n[ ! ] WAARSCHUWING: Je probeert het hele filesystem te verwijderen!\n\n[ ? ] TIP: Dit is een safety feature. Gebruik 'reset' als je opnieuw wilt beginnen.":`rm: ${e.message}`}},manPage:"\nNAAM\n    rm - remove files or directories\n\nSYNOPSIS\n    rm [OPTIONS] <FILE>\n\nBESCHRIJVING\n    Verwijder bestanden of directories. Let op: verwijderde bestanden kunnen\n    niet worden hersteld (behalve met 'reset' voor het hele filesystem).\n\nOPTIES\n    -r, -R, --recursive\n        Verwijder directories en hun inhoud recursief\n\nARGUMENTEN\n    FILE\n        Bestand of directory om te verwijderen (verplicht)\n\nVOORBEELDEN\n    rm test.txt\n        Verwijder een bestand\n\n    rm -r testdir\n        Verwijder een directory en alle inhoud\n\n    rm /tmp/oldfile\n        Verwijder een bestand met absoluut pad\n\nEDUCATIEVE TIPS\n    [ ! ] GEVAARLIJK COMMANDO!\n       rm verwijdert permanent. In echte systemen is er geen \"Recycle Bin\"\n       of \"Prullenbak\". Eenmaal weg = weg.\n\n    [ ! ] Safety features in deze simulator:\n       • Kritieke system directories kunnen niet verwijderd worden\n       • Root directory (/) is beveiligd\n       • Gebruik 'reset' om alles terug te zetten\n\n    [ ? ] Best practices:\n       • Gebruik 'ls' VOOR 'rm' om te verifiëren wat je gaat verwijderen\n       • Bij directories: eerst 'ls <dir>' om te zien wat erin zit\n       • Wees extra voorzichtig met -r (recursief)\n\n    [ ! ] In real pentesting:\n       • rm -rf kan gebruikt worden om sporen uit te wissen (anti-forensics)\n       • Logs verwijderen is vaak een red flag voor defenders\n       • NOOIT op productie systemen gebruiken zonder backup!\n\n    [ ^ ] Famous disasters:\n       \"rm -rf /\" is berucht omdat het het hele systeem verwijdert.\n       Moderne Linux versies hebben safety checks, maar wees voorzichtig!\n\nVEELGEMAAKTE FOUTEN\n    [ X ] rm directory (zonder -r)\n       → Gebruik 'rm -r directory' voor directories\n\n    [ X ] rm -rf / (proberen alles te verwijderen)\n       → Geblokkeerd in deze simulator als safety feature\n\nGERELATEERDE COMMANDO'S\n    ls, mkdir, touch, reset\n".trim()};