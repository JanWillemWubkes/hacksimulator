function e(n,i,t){const s=[];if(!n||"directory"!==n.type||!n.children)return s;for(const[a,o]of Object.entries(n.children)){const n="/"===i?`/${a}`:`${i}/${a}`;if(a.toLowerCase().includes(t)&&s.push(n),"directory"===o.type){const i=e(o,n,t);s.push(...i)}}return s}export default{name:"find",category:"filesystem",description:"Search for files by name",usage:"find <pattern>",async execute(n,i,t){const{vfs:s}=t;if(0===n.length)return"find: missing search pattern\n\n[?] TIP: Gebruik 'find <patroon>' om bestanden te zoeken. Bijvoorbeeld: find passwd";const a=n[0].toLowerCase();try{const i=e(s.fs["/"],"/",a);if(0===i.length)return`find: no files matching '${n[0]}' found\n\n[?] TIP: De zoekterm is case-insensitive en zoekt in bestandsnamen.`;return i.join("\n")+(i.length>5?`\n\n[?] ${i.length} resultaten gevonden. Gebruik 'cat <pad>' om een bestand te lezen.`:"\n\n[?] Gebruik 'cat <pad>' om de inhoud te bekijken.")}catch(e){return`find: ${e.message}`}},manPage:"\nNAAM\n    find - search for files and directories\n\nSYNOPSIS\n    find <PATTERN>\n\nBESCHRIJVING\n    Zoek recursief naar bestanden en directories waarvan de naam het opgegeven\n    patroon bevat. De zoekopdracht is case-insensitive en doorzoekt het hele\n    filesystem vanaf de root directory.\n\nARGUMENTEN\n    PATTERN\n        Zoekpatroon (wordt gezocht in bestandsnamen, case-insensitive)\n\nVOORBEELDEN\n    find passwd\n        Zoek alle bestanden met 'passwd' in de naam\n\n    find log\n        Zoek alle log-gerelateerde bestanden\n\n    find .ssh\n        Zoek SSH configuratie bestanden/directories\n\n    find txt\n        Zoek alle .txt bestanden\n\nEDUCATIEVE TIPS\n    [?] find is een krachtige tool voor reconnaissance:\n       • Ontdek de structuur van een systeem\n       • Vind interessante configuratie bestanden\n       • Zoek credentials, keys, of gevoelige data\n\n    [?] Handige zoekopdrachten in pentesting:\n       • find ssh       → SSH keys en configuratie\n       • find passwd    → User database bestanden\n       • find log       → System logs\n       • find config    → Configuratiebestanden\n       • find shadow    → Password hash files\n       • find key       → Encryption keys\n\n    [→] In real Linux:\n       Real 'find' is veel krachtiger:\n       • find / -name \"*.conf\"     → Zoek met wildcards\n       • find /home -type f        → Alleen files, geen directories\n       • find / -user root         → Bestanden van specifieke user\n       • find / -perm 777          → Bestanden met specifieke permissies\n\n    [+]️ Pentesting workflow:\n       1. find passwd     → Vind user databases\n       2. cat <result>    → Bekijk inhoud\n       3. grep <pattern>  → Zoek specifieke strings in inhoud\n\n    [!] In deze simulator:\n       • Simpele substring matching (geen regex of wildcards)\n       • Case-insensitive zoeken\n       • Altijd vanaf root directory (/)\n\nVERSCHIL MET GREP\n    - find → Zoekt in BESTANDSNAMEN\n    - grep → Zoekt in BESTANDSINHOUD\n\nGERELATEERDE COMMANDO'S\n    grep, ls, cat, locate (locate niet beschikbaar in simulator)\n".trim()};