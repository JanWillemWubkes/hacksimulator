export default{name:"grep",category:"filesystem",description:"Search for patterns in files",usage:"grep <pattern> <file>",async execute(e,n,t){const{vfs:r}=t;if(e.length<2)return`grep: ${0===e.length?"missing pattern":"missing file operand"}\n\n[?] TIP: Gebruik 'grep <patroon> <bestand>' om in een bestand te zoeken. Bijvoorbeeld: grep "root" /etc/passwd`;const s=e[0].toLowerCase(),i=e[1];try{const n=r.readFile(i).split("\n"),t=[];for(let e=0;e<n.length;e++)n[e].toLowerCase().includes(s)&&t.push(`${e+1}: ${n[e]}`);if(0===t.length)return`grep: no matches found for '${e[0]}' in ${i}\n\n[?] TIP: grep zoekt case-insensitive naar tekst in bestanden.`;return t.join("\n")+(t.length>1?`\n\n[?] ${t.length} regels gevonden met '${e[0]}'. Het getal toont de regelnummer.`:"\n\n[?] 1 regel gevonden. Het getal toont de regelnummer.")}catch(e){return e.message.includes("No such file")?`grep: ${i}: No such file or directory\n\n[?] TIP: Gebruik 'find' om bestanden te zoeken, of 'ls' om te zien wat er in de directory staat.`:e.message.includes("Is a directory")?`grep: ${i}: Is a directory\n\n[?] TIP: grep werkt op bestanden, niet directories. Probeer: ls ${i}`:e.message.includes("Permission denied")?`grep: ${i}: Permission denied\n\n[!] BEVEILIGING: Dit bestand is beveiligd. Probeer een ander bestand zoals /etc/passwd.`:`grep: ${e.message}`}},manPage:'\nNAAM\n    grep - search for patterns in file contents\n\nSYNOPSIS\n    grep <PATTERN> <FILE>\n\nBESCHRIJVING\n    Zoek naar een tekst patroon in de inhoud van een bestand. Alle regels\n    die het patroon bevatten worden getoond met regelnummer.\n\nARGUMENTEN\n    PATTERN\n        De zoektekst (case-insensitive in deze simulator)\n\n    FILE\n        Het bestand waarin gezocht moet worden (verplicht)\n\nVOORBEELDEN\n    grep "root" /etc/passwd\n        Zoek naar regels met "root" in het passwd bestand\n\n    grep "hacker" /etc/passwd\n        Zoek je eigen gebruiker\n\n    grep "ssh" /var/log/auth.log\n        Zoek SSH gerelateerde log entries\n\n    grep "failed" /var/log/auth.log\n        Zoek mislukte login pogingen\n\nEDUCATIEVE TIPS\n    [?] grep is essentieel voor log analyse en reconnaissance:\n       • Zoek gebruikersnamen in /etc/passwd\n       • Analyseer security events in logs\n       • Vind configuratie opties in config files\n\n    [?] Pentesting use cases:\n       • grep "password" <file>  → Zoek credentials in files\n       • grep "admin" /etc/passwd → Zoek admin accounts\n       • grep "failed" auth.log   → Brute force detectie\n       • grep "error" syslog      → System vulnerabilities\n\n    [→] Interessante patronen om te zoeken:\n       • "root"     → Root/admin gerelateerd\n       • "password" → Mogelijk credentials\n       • "failed"   → Failed login attempts\n       • "ssh"      → Remote access\n       • "error"    → System errors\n\n    [+] In real Linux:\n       Real \'grep\' ondersteunt:\n       • grep -i      → Case-insensitive (standaard in simulator)\n       • grep -n      → Toon regelnummers (standaard in simulator)\n       • grep -r      → Recursief door directories\n       • grep -E      → Extended regex patterns\n       • grep -v      → Inverse match (regels ZONDER patroon)\n\n    [↻] Workflow voorbeeld:\n       1. find passwd           → Vind passwd bestanden\n       2. cat /etc/passwd       → Bekijk inhoud\n       3. grep "root" /etc/passwd → Filter specifieke entries\n\nVERSCHIL MET FIND\n    - grep → Zoekt in BESTANDSINHOUD (tekst in het bestand)\n    - find → Zoekt in BESTANDSNAMEN (naam van het bestand)\n\nGERELATEERDE COMMANDO\'S\n    find, cat, ls, awk, sed (awk/sed niet beschikbaar in simulator)\n'.trim()};