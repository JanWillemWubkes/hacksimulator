import t from"../filesystem/vfs.js";export function getPathCompletions(e,r={}){const{type:i="both",showHidden:s=!1}=r;try{const{directory:r,prefix:n,inputStyle:o}=function(e){if(!e||"."===e)return{directory:t.getCwd(),prefix:"",inputStyle:"relative"};let r="relative";e.startsWith("/")?r="absolute":e.startsWith("~")&&(r="tilde");let i=e;if(e.startsWith("~")){const t="/home/hacker";i="~"===e?t:t+e.slice(1)}const s=i.lastIndexOf("/");if(-1===s)return{directory:t.getCwd(),prefix:i,inputStyle:"relative"};const n=i.slice(0,s)||"/",o=i.slice(s+1);return{directory:t.resolvePath(n),prefix:o,inputStyle:r}}(e),c=function(t,e,r){const i=e.toLowerCase();return t.filter(t=>("directory"!==r||"directory"===t.type)&&("file"!==r||"file"===t.type)&&t.name.toLowerCase().startsWith(i))}(t.listDirectory(r,s),n,i);return function(t,e,r,i){const s="/home/hacker";return t.map(t=>{const n="directory"===t.type?t.name+"/":t.name;switch(r){case"absolute":return"/"===e?"/"+n:e+"/"+n;case"tilde":return e===s?"~/"+n:e.replace(s,"~")+"/"+n;default:if(i.includes("/")&&!i.startsWith("/")&&!i.startsWith("~")){const t=i.lastIndexOf("/");return i.slice(0,t+1)+n}return n}})}(c,r,o,e)}catch(t){return[]}}