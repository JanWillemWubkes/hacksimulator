export default new class{constructor(){this.isFirstVisit=!0,this.commandCount=0,this.hasShownEncouragement=!1,this.hasShownTabHint=!1,this.hasShownTutorialSuggestion=!1,this.hasShownCtrlRHint=!1,this.hasShownCtrlLHint=!1,this.hasShownNoOutputHint=!1,this.FILESYSTEM_COMMANDS=["cd","cp","mkdir","mv","rm","touch"],this.STORAGE_KEY_FIRST_VISIT="hacksim_first_visit",this.STORAGE_KEY_COMMAND_COUNT="hacksim_command_count",this.STORAGE_KEY_ONBOARDING_STATE="hacksim_onboarding_state",this.STORAGE_KEY_COMMANDS_TRIED="hacksim_commands_tried"}init(){try{const t=localStorage.getItem(this.STORAGE_KEY_FIRST_VISIT);this.isFirstVisit=null===t;const n=localStorage.getItem(this.STORAGE_KEY_COMMAND_COUNT);this.commandCount=n?parseInt(n,10):0;const e=localStorage.getItem(this.STORAGE_KEY_ONBOARDING_STATE);if(e)try{const t=JSON.parse(e);this.hasShownEncouragement=t.hasShownEncouragement||!1,this.hasShownTabHint=t.hasShownTabHint||!1,this.hasShownTutorialSuggestion=t.hasShownTutorialSuggestion||!1,this.hasShownCtrlRHint=t.hasShownCtrlRHint||!1,this.hasShownCtrlLHint=t.hasShownCtrlLHint||!1,this.hasShownNoOutputHint=t.hasShownNoOutputHint||!1}catch(t){console.warn("Failed to parse onboarding state:",t)}console.log("Onboarding initialized:",{isFirstVisit:this.isFirstVisit,commandCount:this.commandCount})}catch(t){console.error("Failed to initialize onboarding:",t),this.isFirstVisit=!0,this.commandCount=0}}isFirstTimeVisitor(){return this.isFirstVisit}getWelcomeMessage(){return this.isFirstVisit?this._getFirstTimeWelcome():this._getReturningVisitorWelcome()}_getFirstTimeWelcome(){return"\n[SEPARATOR]\n[***] HACKSIMULATOR.NL - ETHICAL HACKING\n[SEPARATOR]\n\n[ ✓ ] Toegang verleend\n\nJe bent ingelogd op een gesimuleerd netwerk.\nJe missie: leer de tools die ethical hackers\ngebruiken om systemen te beveiligen - volledig\nveilig en legaal.\n\n[ ! ] Real hackers beginnen met de basics:\n\n→ FASE 1: Terminal basics     ('ls', 'cd', 'pwd')\n→ FASE 2: File manipulation   ('mkdir', 'touch', 'rm')\n→ FASE 3: Network scanning    ('ping', 'nmap')\n→ FASE 4: Security tools      ('hashcat', 'hydra')\n\n→ Type 'help' om te beginnen\n→ Type 'leerpad' om voortgang te volgen\n".trim()}_getReturningVisitorWelcome(){return"\n[SEPARATOR]\n[***] Welkom terug in het lab, hacker\n[SEPARATOR]\n\n[ ✓ ] Systeem gereed → Type 'help' voor nieuwe opdrachten\n".trim()}markFirstVisitComplete(){if(this.isFirstVisit)try{localStorage.setItem(this.STORAGE_KEY_FIRST_VISIT,"false"),this.isFirstVisit=!1}catch(t){console.warn("Could not save first visit state:",t)}}recordCommand(t=null){this.commandCount++;try{localStorage.setItem(this.STORAGE_KEY_COMMAND_COUNT,this.commandCount.toString())}catch(t){console.warn("Could not save command count:",t)}return t&&this._trackCommand(t),this._saveState(),this._getProgressiveHint()}_trackCommand(t){try{const n=localStorage.getItem(this.STORAGE_KEY_COMMANDS_TRIED),e=n?n.split(",").filter(t=>t.trim()):[];e.includes(t)||(e.push(t),localStorage.setItem(this.STORAGE_KEY_COMMANDS_TRIED,e.join(",")))}catch(t){console.warn("Could not track command:",t)}}_getProgressiveHint(){return 1!==this.commandCount||this.hasShownEncouragement?3!==this.commandCount||this.hasShownTabHint?5!==this.commandCount||this.hasShownTutorialSuggestion?7!==this.commandCount||this.hasShownCtrlRHint?10===this.commandCount?"\n[ ! ] 10 opdrachten - tijd voor krachtigere tools\n\n[ ! ] LET OP: De volgende tools zijn ALLEEN voor educatief gebruik.\n      In de echte wereld zijn ze illegaal zonder expliciete toestemming.\n\nKlaar? Type 'help security' voor geavanceerde tools.":12!==this.commandCount||this.hasShownCtrlLHint?null:(this.hasShownCtrlLHint=!0,this._saveState(),"\n[ ✓ ] Is je terminal vol? Gebruik Ctrl+L om te leegmaken\n\n(Net als echte Linux terminals - geen rommelige output meer!)"):(this.hasShownCtrlRHint=!0,this._saveState(),"\n[ ✓ ] Pro tip: Gebruik Ctrl+R om door je geschiedenis te zoeken\n\nProbeer het nu:\n→ Druk Ctrl+R en type \"ls\"     - Vind vorige ls commands\n→ Druk Ctrl+R opnieuw          - Cycle door matches\n→ Enter om te accepteren       - Esc om te annuleren\n\nType 'shortcuts' voor alle keyboard shortcuts."):(this.hasShownTutorialSuggestion=!0,this._saveState(),"\n[ ✓ ] 5 opdrachten voltooid - je bent onderweg!\n\nKlaar voor reconnaissance? Ethical hackers beginnen altijd\nmet informatie verzamelen:\n→ 'nmap 192.168.1.1' - Scan een netwerk\n→ 'man nmap'         - Leer hoe het werkt"):(this.hasShownTabHint=!0,this._saveState(),'\n[ ✓ ] Pro tip: Gebruik Tab om commands snel in te typen\n\nProbeer het nu:\n→ Type "nm" en druk Tab      - Vult aan naar "nmap"\n→ Type "l" en druk Tab 2x    - Cyclet door ls, ln, ...'):(this.hasShownEncouragement=!0,this._saveState(),"\n[ ✓ ] Eerste opdracht voltooid!\n\nOntdek je omgeving:\n→ 'ls'   - Bekijk bestanden in deze map\n→ 'help' - Zie alle beschikbare hacking tools")}_saveState(){try{const t={hasShownEncouragement:this.hasShownEncouragement,hasShownTabHint:this.hasShownTabHint,hasShownTutorialSuggestion:this.hasShownTutorialSuggestion,hasShownCtrlRHint:this.hasShownCtrlRHint,hasShownCtrlLHint:this.hasShownCtrlLHint,hasShownNoOutputHint:this.hasShownNoOutputHint};localStorage.setItem(this.STORAGE_KEY_ONBOARDING_STATE,JSON.stringify(t))}catch(t){console.warn("Could not save onboarding state:",t)}}getPersistentHint(){return this.commandCount>=5?null:'Type "help" voor commands'}reset(){try{localStorage.removeItem(this.STORAGE_KEY_FIRST_VISIT),localStorage.removeItem(this.STORAGE_KEY_COMMAND_COUNT),localStorage.removeItem(this.STORAGE_KEY_ONBOARDING_STATE),localStorage.removeItem(this.STORAGE_KEY_COMMANDS_TRIED)}catch(t){console.warn("Could not reset onboarding state:",t)}this.isFirstVisit=!0,this.commandCount=0,this.hasShownEncouragement=!1,this.hasShownTabHint=!1,this.hasShownTutorialSuggestion=!1,this.hasShownCtrlRHint=!1,this.hasShownCtrlLHint=!1,this.hasShownNoOutputHint=!1,console.log("Onboarding reset")}getStats(){return{isFirstVisit:this.isFirstVisit,commandCount:this.commandCount,hasShownEncouragement:this.hasShownEncouragement,hasShownTabHint:this.hasShownTabHint,hasShownTutorialSuggestion:this.hasShownTutorialSuggestion,hasShownCtrlRHint:this.hasShownCtrlRHint,hasShownCtrlLHint:this.hasShownCtrlLHint,hasShownNoOutputHint:this.hasShownNoOutputHint}}getFilesystemHint(t){return!this.hasShownNoOutputHint&&this.FILESYSTEM_COMMANDS.includes(t)?(this.hasShownNoOutputHint=!0,this._saveState(),'\n[?] Wist je dat? In echte Linux tonen commands zoals cd, cp en rm geen output bij succes.\n    Dit heet "no news is good news". Deze simulator toont bevestigingen zodat je leert wat er gebeurt.'):null}};