import t from"../core/registry.js";import e from"../filesystem/vfs.js";export default new class{constructor(){this.lastInput="",this.matches=[],this.currentMatchIndex=0}complete(t){const e=t.trim();if(!e)return null;if(this.matches.length>0&&this.matches.includes(e)||(this.lastInput=e,this.matches=this._findMatches(e),this.currentMatchIndex=0),0===this.matches.length)return null;if(1===this.matches.length)return this.matches[0];const s=this.matches[this.currentMatchIndex];return this.currentMatchIndex=(this.currentMatchIndex+1)%this.matches.length,s}getMatches(t){return this._findMatches(t.trim())}_findMatches(t){const e=t.split(/\s+/);if(1===e.length)return this._matchCommands(e[0]);{const t=e[0],s=e.slice(1),n=e[e.length-1],h=this._matchArguments(t,s,n);if(h.length>0){const t=e.slice(0,-1).join(" ");return h.map(e=>`${t} ${e}`.trim())}return[]}}_matchCommands(e){const s=t.list(),n=e.toLowerCase();return s.filter(t=>t.toLowerCase().startsWith(n))}_matchArguments(e,s,n){const h=t.getCompletions(e,s);if(0===h.length)return[];const r=n.toLowerCase();return h.filter(t=>t.toLowerCase().startsWith(r))}_matchPaths(t,e){return[]}reset(){this.lastInput="",this.matches=[],this.currentMatchIndex=0}getHint(t){const e=this.getMatches(t);return 0===e.length?null:1===e.length?`\n[ TAB ] Druk Tab om te completeren: ${e[0]}`:e.length<=5?`\n[ TAB ] Mogelijke commando's:\n  ${e.join(", ")}`:`\n[ TAB ] ${e.length} mogelijke commando's (druk Tab om te cyclen)`}};